{% extends "base.html" %}
{% block content %}
<section class="glass-panel">
  <div class="panel-header">
    <div>
      <p class="eyebrow accent">Admin tools</p>
      <h2>Realtime usage monitor</h2>
      <p class="muted">Paste an admin JWT below to pull stats directly from the API.</p>
    </div>
  </div>
  <label for="token" class="label">Bearer token</label>
  <textarea id="token" rows="3" class="input"></textarea>
  <div class="cta-row">
    <button id="load" class="btn primary">Load summary</button>
    <a class="btn secondary" href="/docs" target="_blank">Open Swagger</a>
  </div>
</section>
<section class="glass-panel" id="output">
  <p class="muted">Awaiting request...</p>
</section>
<script>
  const loadBtn = document.getElementById("load");
  const out = document.getElementById("output");
  loadBtn.addEventListener("click", async () => {
    out.innerHTML = "<p class='muted'>Loadingâ€¦</p>";
    const token = document.getElementById("token").value.trim();
    const resp = await fetch("/admin/summary", {
      headers: { Authorization: `Bearer ${token}` },
    });
    if (!resp.ok) {
      out.innerHTML = `<p class="error">Error: ${resp.status} ${resp.statusText}</p>`;
      return;
    }
    const data = await resp.json();
    out.innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
  });
</script>
{% endblock %}

